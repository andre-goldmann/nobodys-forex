<div class="container mx-auto">
  <!--button class="btn">Button</button-->
  <!-- TODO info could be null?? -->
  @if(userStoreService.getUser() && userStoreService.getUser().info){
  <p>Loged in as: {{userStoreService.getUser().info.preferred_username}}</p>
  }
  @else{
  <p>Could not show User-Info</p>
  <div>{{userStoreService.getUser().info | json}}</div>
  }
  <!--button (click)="updateTrade()" class="btn btn-primary">Update Trade</button>
  <p> TODO Endpoint updateProdTrades</p-->

  <p>WaitingTrades</p>
  {{waitingTrades | json}}
<!-- TODO this should be in another view -->
<!-- Maximum two tabs, everything else in a new view-->
<!-- convert tables to panels -->

  <p>Just published Signals</p>
  <div class="overflow-x-auto">
    <table class="table-auto w-full">
      <thead>
        <tr>
          <th class="px-4 py-2">Symbol</th>
          <th class="px-4 py-2">Strategy</th>
          <th class="px-4 py-2">Type</th>
          <th class="px-4 py-2">Entry</th>
          <th class="px-4 py-2">SL</th>
          <th class="px-4 py-2">TP</th>
          <th class="px-4 py-2">Ignored</th>
          <th class="px-4 py-2">Ignored Message</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let signal of signals()" class="text-center">
          <td class="border px-4 py-2">{{ signal.symbol }}</td>
          <td class="border px-4 py-2">{{ signal.strategy }}</td>
          <td class="border px-4 py-2">{{ signal.type }}</td>
          <td class="border px-4 py-2">{{ signal.entry }}</td>
          <td class="border px-4 py-2">{{ signal.sl }}</td>
          <td class="border px-4 py-2">{{ signal.tp }}</td>
          <td class="border px-4 py-2">{{ signal.ignrored }}</td>
          <td class="border px-4 py-2">{{ signal.ignroredMessage }}</td>
        </tr>
      </tbody>
    </table>
  </div>


  <div class="flex flex-col justify-around spacy-y-4">
    <div *ngFor="let item of map | keyvalue" class="w-full max-w-sm rounded overflow-hidden shadow-lg m-4"[ngClass]="{'green-background': item.value.length > 1}">
      <div class="px-6 py-4">
        <div class="font-bold text-xl mb-2">{{item.key.split("-")[0]}}</div>
        <p class="text-gray-700 text-base">
          {{item.key.split("-")[1]}}
        </p>
      </div>
      <div class="px-6 pt-4 pb-2">

        @if (item.value.length > 1){
          <table>
            <thead>
            <th class="px-4 py-2">System</th>
            <th class="px-4 py-2">Wins</th>
            <th class="px-4 py-2">Loses</th>
            <th class="px-4 py-2">Percentage</th>
            <th class="px-4 py-2">Profit</th>
            </thead>
            <tr *ngFor="let stat of item.value; let i = index;">
              @if (item.value.length > 1 && i == 0){
                <td class="border px-4 py-2">Dev</td>
              } @else if (item.value.length > 1 && i == 1){
                <td class="border px-4 py-2">Prod</td>
              }
              <td class="border px-4 py-2">{{stat.wins}}</td>
              <td class="border px-4 py-2">{{stat.loses}}</td>
              <td class="border px-4 py-2">{{stat.winpercentage}}</td>
              <td class="border px-4 py-2">{{stat.profit}}</td>
            </tr>
          </table>
        } @else {
          <table border="0">
            <thead>
            <th class="px-4 py-2">Wins</th>
            <th class="px-4 py-2">Loses</th>
            <th class="px-4 py-2">Percentage</th>
            <th class="px-4 py-2">Profit</th>
            </thead>
            <tr *ngFor="let stat of item.value">
              <td class="border px-4 py-2">{{stat.wins}}</td>
              <td class="border px-4 py-2">{{stat.loses}}</td>
              <td class="border px-4 py-2">{{stat.winpercentage}}</td>
              <td class="border px-4 py-2">{{stat.profit}}</td>
            </tr>
          </table>
        }

      </div>

    </div>
  </div>
</div>
